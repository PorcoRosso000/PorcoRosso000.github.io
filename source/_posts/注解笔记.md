---
title: 注解笔记
typora-root-url: 注解笔记
abbrlink: 271ebaf8
date: 2023-01-07 14:28:42
tags:
permalink:
---

### @Compensable

@Compensable注解问题

若try的实现逻辑写在serviceImpl中，而不是controller中，那么，@Compensable需要添加在controller中，而不是serviceImpl中。 如果仅仅添加在serviceImpl中，那么confirm或者cancel将不会执行; 如果controller和serviceImpl都添加，那么，confirm或者cancel会执行2遍；



### @SuppressWarnings注解的作用

告诉编译器忽略指定的警告，不在编译完成后出现警告信息，这些警告信息显示在代码左侧行列栏，会挡住调试时的断点。可注解类、字段、方法、参数、局部变量、构造函数。

## 使用方式

-  `@SuppressWarnings("")`  如: `@SuppressWarnings("unchecked")`，`@SuppressWarnings("unchecked","rawtypes")` 
-  `@SuppressWarnings({})`  如: `@SuppressWarnings({"unchecked","rawtypes"})` 
-  `@SuppressWarnings(value={})` 如: `@SuppressWarnings(value={"unchecked","rawtypes"})` 



```java
@SuppressWarnings("static-access")
public void fo(){
...
}
```

### 用途列表

根据使用需要，选择表中的关键字。

| 关键字                   | 用途                                                         |
| :----------------------- | :----------------------------------------------------------- |
| all                      | to suppress all warnings  （抑制所有警告）                   |
| boxing                   | to suppress warnings relative to boxing/unboxing operations   （抑制装箱、拆箱操作时候的警告） |
| cast                     | to suppress warnings relative to cast operations   （抑制映射相关的警告） |
| dep-ann                  | to suppress warnings relative to deprecated annotation   （抑制启用注释的警告） |
| deprecation              | to suppress warnings relative to deprecation   （抑制过期方法警告） |
| fallthrough              | to suppress warnings relative to missing breaks in switch statements   （抑制确在switch中缺失breaks的警告） |
| finally                  | to suppress warnings relative to finally block that don’t return   （抑制finally模块没有返回的警告） |
| hiding                   | to suppress warnings relative to locals that hide variable  （抑制相对于隐藏变量的局部变量的警告） |
| incomplete-switch        | to suppress warnings relative to missing entries in a switch statement (enum case)  （忽略没有完整的switch语句） |
| nls                      | to suppress warnings relative to non-nls string literals  （ 忽略非nls格式的字符） |
| null                     | to suppress warnings relative to null analysis  （ 忽略对null的操作） |
| rawtypes                 | to suppress warnings relative to un-specific types when using generics on class params  （ 使用generics时忽略没有指定相应的类型） |
| restriction              | to suppress warnings relative to usage of discouraged or forbidden references  （ 抑制禁止使用劝阻或禁止引用的警告） |
| serial                   | to suppress warnings relative to missing serialVersionUID field for a serializable class  （ 忽略在serializable类中没有声明serialVersionUID变量） |
| static-access            | to suppress warnings relative to incorrect static access （ 抑制不正确的静态访问方式警告） |
| synthetic-access         | to suppress warnings relative to unoptimized access from inner classes  （ 抑制子类没有按最优方法访问内部类的警告） |
| unchecked                | to suppress warnings relative to unchecked operations  （ 抑制没有进行类型检查操作的警告） |
| unqualified-field-access | to suppress warnings relative to field access unqualifiedv （ 抑制没有权限访问的域的警告） |
| unused                   | to suppress warnings relative to unused code  （ 抑制没被使用过的代码的警告） |



### @Valid

用于验证注解是否符合要求，直接加在变量user之前，在变量中添加验证信息的要求，当不符合要求时就会在方法中返回message 的错误提示信息。

```
@RestController
@RequestMapping("/user")
public class UserController {
    @PostMapping
    public User create (@Valid @RequestBody User user) {
        System.out.println(user.getId());
        System.out.println(user.getUsername());
        System.out.println(user.getPassword());
        user.setId("1");
        return user;
    }
}    
```


然后在 User 类中添加验证信息的要求：

```
public class User {
    private String id;  
    @NotBlank(message = "密码不能为空")
    private String password;
}
@NotBlank 注解所指的 password 字段，表示验证密码不能为空，如果为空的话，上面 Controller 中的 create 方法会将message 中的"密码不能为空"返回。
```



当然也可以添加其他验证信息的要求：

限制	说明
@Null	限制只能为null
@NotNull	限制必须不为null
@AssertFalse	限制必须为false
@AssertTrue	限制必须为true
@DecimalMax(value)	限制必须为一个不大于指定值的数字
@DecimalMin(value)	限制必须为一个不小于指定值的数字
@Digits(integer,fraction)	限制必须为一个小数，且整数部分的位数不能超过integer，小数部分的位数不能超过fraction
@Future	限制必须是一个将来的日期
@Max(value)	限制必须为一个不大于指定值的数字
@Min(value)	限制必须为一个不小于指定值的数字
@Past	限制必须是一个过去的日期
@Pattern(value)	限制必须符合指定的正则表达式
@Size(max,min)	限制字符长度必须在min到max之间
@Past	验证注解的元素值（日期类型）比当前时间早
@NotEmpty	验证注解的元素值不为null且不为空（字符串长度不为0、集合大小不为0）
@NotBlank	验证注解的元素值不为空（不为null、去除首位空格后长度为0），不同于@NotEmpty，@NotBlank只应用于字符串且在比较时会去除字符串的空格
@Email	验证注解的元素值是Email，也可以通过正则表达式和flag指定自定义的email格式



    除此之外还可以自定义验证信息的要求，例如下面的 @MyConstraint：
    
    public class User {
    private String id;
     
    @MyConstraint(message = "这是一个测试")
    private String username;
    }
    
    注解的具体内容：
    
    @Constraint(validatedBy = {MyConstraintValidator.class})
    @Target({ELementtype.METHOD, ElementType.FIELD})
    @Retention(RetentionPolicy.RUNTIME)
    public @interface MyConstraint {
        String message();
        Class<?>[] groups() default {};
        Class<? extends Payload>[] payload() default {}; 
    }



下面是校验器：

```
public class MyConstraintValidator implements ConstraintValidator<MyConstraint, Object> {
    @Autowired
    private UserService userService;
    
    @Override
    public void initialie(@MyConstraint constarintAnnotation) {
        System.out.println("my validator init");
    }
    
    @Override
    public boolean isValid(Object value, ConstraintValidatorContext context) {
        userService.getUserByUsername("seina");
        System.out.println("valid");
        return false;
    }
}
```



### 参考文献:

简书  [温暖的纯真](https://www.jianshu.com/u/38d4b16b1209):https://www.jianshu.com/p/c399490f24a2

CSDN「笙南」：https://blog.csdn.net/weixin_38118016/article/details/80977207